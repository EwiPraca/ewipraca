/*!
 * jCarousel - Riding carousels with jQuery
 *   http://sorgalla.com/jcarousel/
 *
 * Copyright (c) 2006 Jan Sorgalla (http://sorgalla.com)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Built on top of the jQuery library
 *   http://jquery.com
 *
 * Inspired by the "Carousel Component" by Bill Scott
 *   http://billwscott.com/carousel/
 */
(function(n){var r={vertical:!1,rtl:!1,start:1,offset:1,size:null,scroll:3,visible:null,animation:"normal",easing:"swing",auto:0,wrap:null,initCallback:null,setupCallback:null,reloadCallback:null,itemLoadCallback:null,itemFirstInCallback:null,itemFirstOutCallback:null,itemLastInCallback:null,itemLastOutCallback:null,itemVisibleInCallback:null,itemVisibleOutCallback:null,animationStepCallback:null,buttonNextHTML:"<div><\/div>",buttonPrevHTML:"<div><\/div>",buttonNextEvent:"click",buttonPrevEvent:"click",buttonNextCallback:null,buttonPrevCallback:null,itemFallbackDimension:null},i=!1,t;n(window).bind("load.jcarousel",function(){i=!0});n.jcarousel=function(t,u){var s,o,e,c,l;for(this.options=n.extend({},r,u||{}),this.locked=!1,this.autoStopped=!1,this.container=null,this.clip=null,this.list=null,this.buttonNext=null,this.buttonPrev=null,this.buttonNextState=null,this.buttonPrevState=null,u&&u.rtl!==undefined||(this.options.rtl=(n(t).attr("dir")||n("html").attr("dir")||"").toLowerCase()=="rtl"),this.wh=this.options.vertical?"height":"width",this.lt=this.options.vertical?"top":this.options.rtl?"right":"left",s="",o=t.className.split(" "),e=0;e<o.length;e++)if(o[e].indexOf("jcarousel-skin")!=-1){n(t).removeClass(o[e]);s=o[e];break}t.nodeName.toUpperCase()=="UL"||t.nodeName.toUpperCase()=="OL"?(this.list=n(t),this.clip=this.list.parents(".jcarousel-clip"),this.container=this.list.parents(".jcarousel-container")):(this.container=n(t),this.list=this.container.find("ul,ol").eq(0),this.clip=this.container.find(".jcarousel-clip"));this.clip.size()===0&&(this.clip=this.list.wrap("<div><\/div>").parent());this.container.size()===0&&(this.container=this.clip.wrap("<div><\/div>").parent());s!==""&&this.container.parent()[0].className.indexOf("jcarousel-skin")==-1&&this.container.wrap('<div class=" '+s+'"><\/div>');this.buttonPrev=n(".jcarousel-prev",this.container);this.buttonPrev.size()===0&&this.options.buttonPrevHTML!==null&&(this.buttonPrev=n(this.options.buttonPrevHTML).appendTo(this.container));this.buttonPrev.addClass(this.className("jcarousel-prev"));this.buttonNext=n(".jcarousel-next",this.container);this.buttonNext.size()===0&&this.options.buttonNextHTML!==null&&(this.buttonNext=n(this.options.buttonNextHTML).appendTo(this.container));this.buttonNext.addClass(this.className("jcarousel-next"));this.clip.addClass(this.className("jcarousel-clip")).css({position:"relative"});this.list.addClass(this.className("jcarousel-list")).css({overflow:"hidden",position:"relative",top:0,margin:0,padding:0}).css(this.options.rtl?"right":"left",0);this.container.addClass(this.className("jcarousel-container")).css({position:"relative"});!this.options.vertical&&this.options.rtl&&this.container.addClass("jcarousel-direction-rtl").attr("dir","rtl");var a=this.options.visible!==null?Math.ceil(this.clipping()/this.options.visible):null,h=this.list.children("li"),f=this;h.size()>0&&(c=0,l=this.options.offset,h.each(function(){f.format(this,l++);c+=f.dimension(this,a)}),this.list.css(this.wh,c+100+"px"),u&&u.size!==undefined||(this.options.size=h.size()));this.container.css("display","block");this.buttonNext.css("display","block");this.buttonPrev.css("display","block");this.funcNext=function(){f.next()};this.funcPrev=function(){f.prev()};this.funcResize=function(){f.resizeTimer&&clearTimeout(f.resizeTimer);f.resizeTimer=setTimeout(function(){f.reload()},100)};this.options.initCallback!==null&&this.options.initCallback(this,"init");!i&&n.browser.safari?(this.buttons(!1,!1),n(window).bind("load.jcarousel",function(){f.setup()})):this.setup()};t=n.jcarousel;t.fn=t.prototype={jcarousel:"0.2.8"};t.fn.extend=t.extend=n.extend;t.fn.extend({setup:function(){if(this.first=null,this.last=null,this.prevFirst=null,this.prevLast=null,this.animating=!1,this.timer=null,this.resizeTimer=null,this.tail=null,this.inTail=!1,!this.locked){this.list.css(this.lt,this.pos(this.options.offset)+"px");var t=this.pos(this.options.start,!0);this.prevFirst=this.prevLast=null;this.animate(t,!1);n(window).unbind("resize.jcarousel",this.funcResize).bind("resize.jcarousel",this.funcResize);this.options.setupCallback!==null&&this.options.setupCallback(this)}},reset:function(){this.list.empty();this.list.css(this.lt,"0px");this.list.css(this.wh,"10px");this.options.initCallback!==null&&this.options.initCallback(this,"reset");this.setup()},reload:function(){if(this.tail!==null&&this.inTail&&this.list.css(this.lt,t.intval(this.list.css(this.lt))+this.tail),this.tail=null,this.inTail=!1,this.options.reloadCallback!==null&&this.options.reloadCallback(this),this.options.visible!==null){var i=this,u=Math.ceil(this.clipping()/this.options.visible),n=0,r=0;this.list.children("li").each(function(t){n+=i.dimension(this,u);t+1<i.first&&(r=n)});this.list.css(this.wh,n+"px");this.list.css(this.lt,-r+"px")}this.scroll(this.first,!1)},lock:function(){this.locked=!0;this.buttons()},unlock:function(){this.locked=!1;this.buttons()},size:function(n){return n!==undefined&&(this.options.size=n,this.locked||this.buttons()),this.options.size},has:function(n,t){var i,r;for(t!==undefined&&t||(t=n),this.options.size!==null&&t>this.options.size&&(t=this.options.size),i=n;i<=t;i++)if(r=this.get(i),!r.length||r.hasClass("jcarousel-item-placeholder"))return!1;return!0},get:function(t){return n(">.jcarousel-item-"+t,this.list)},add:function(i,r){var u=this.get(i),h=0,e=n(r),o,f,c,s;if(u.length===0){for(f=t.intval(i),u=this.create(i);;)if(o=this.get(--f),f<=0||o.length){f<=0?this.list.prepend(u):o.after(u);break}}else h=this.dimension(u);return e.get(0).nodeName.toUpperCase()=="LI"?(u.replaceWith(e),u=e):u.empty().append(r),this.format(u.removeClass(this.className("jcarousel-item-placeholder")),i),c=this.options.visible!==null?Math.ceil(this.clipping()/this.options.visible):null,s=this.dimension(u,c)-h,i>0&&i<this.first&&this.list.css(this.lt,t.intval(this.list.css(this.lt))-s+"px"),this.list.css(this.wh,t.intval(this.list.css(this.wh))+s+"px"),u},remove:function(n){var i=this.get(n),r;!i.length||n>=this.first&&n<=this.last||(r=this.dimension(i),n<this.first&&this.list.css(this.lt,t.intval(this.list.css(this.lt))+r+"px"),i.remove(),this.list.css(this.wh,t.intval(this.list.css(this.wh))-r+"px"))},next:function(){this.tail===null||this.inTail?this.scroll((this.options.wrap=="both"||this.options.wrap=="last")&&this.options.size!==null&&this.last==this.options.size?1:this.first+this.options.scroll):this.scrollTail(!1)},prev:function(){this.tail!==null&&this.inTail?this.scrollTail(!0):this.scroll((this.options.wrap=="both"||this.options.wrap=="first")&&this.options.size!==null&&this.first==1?this.options.size:this.first-this.options.scroll)},scrollTail:function(n){if(!this.locked&&!this.animating&&this.tail){this.pauseAuto();var i=t.intval(this.list.css(this.lt));i=n?i+this.tail:i-this.tail;this.inTail=!n;this.prevFirst=this.first;this.prevLast=this.last;this.animate(i)}},scroll:function(n,t){this.locked||this.animating||(this.pauseAuto(),this.animate(this.pos(n),t))},pos:function(n,i){var e=t.intval(this.list.css(this.lt)),b,f,y,g;if(this.locked||this.animating)return e;this.options.wrap!="circular"&&(n=n<1?1:this.options.size&&n>this.options.size?this.options.size:n);for(var o=this.first>n,k=this.options.wrap!="circular"&&this.first<=1?1:this.first,c=o?this.get(k):this.get(this.last),r=o?k:k-1,u=null,l=0,p=!1,s=0,a;o?--r>=n:++r<n;)u=this.get(r),p=!u.length,u.length===0&&(u=this.create(r).addClass(this.className("jcarousel-item-placeholder")),c[o?"before":"after"](u),this.first!==null&&this.options.wrap=="circular"&&this.options.size!==null&&(r<=0||r>this.options.size)&&(a=this.get(this.index(r)),a.length&&(u=this.add(r,a.clone(!0))))),c=u,s=this.dimension(u),p&&(l+=s),this.first!==null&&(this.options.wrap=="circular"||r>=1&&(this.options.size===null||r<=this.options.size))&&(e=o?e+s:e-s);var w=this.clipping(),d=[],v=0,h=0;for(c=this.get(n-1),r=n;++v;){if(u=this.get(r),p=!u.length,u.length===0&&(u=this.create(r).addClass(this.className("jcarousel-item-placeholder")),c.length===0?this.list.prepend(u):c[o?"before":"after"](u),this.first!==null&&this.options.wrap=="circular"&&this.options.size!==null&&(r<=0||r>this.options.size)&&(a=this.get(this.index(r)),a.length&&(u=this.add(r,a.clone(!0))))),c=u,s=this.dimension(u),s===0)throw new Error("jCarousel: No width/height set for items. This will cause an infinite loop. Aborting...");if(this.options.wrap!="circular"&&this.options.size!==null&&r>this.options.size?d.push(u):p&&(l+=s),h+=s,h>=w)break;r++}for(b=0;b<d.length;b++)d[b].remove();if(l>0&&(this.list.css(this.wh,this.dimension(this.list)+l+"px"),o&&(e-=l,this.list.css(this.lt,t.intval(this.list.css(this.lt))-l+"px"))),f=n+v-1,this.options.wrap!="circular"&&this.options.size&&f>this.options.size&&(f=this.options.size),r>f)for(v=0,r=f,h=0;++v;){if(u=this.get(r--),!u.length)break;if(h+=this.dimension(u),h>=w)break}for(y=f-v+1,this.options.wrap!="circular"&&y<1&&(y=1),this.inTail&&o&&(e+=this.tail,this.inTail=!1),this.tail=null,this.options.wrap!="circular"&&f==this.options.size&&f-v+1>=1&&(g=t.intval(this.get(f).css(this.options.vertical?"marginBottom":"marginRight")),h-g>w&&(this.tail=h-w-g)),i&&n===this.options.size&&this.tail&&(e-=this.tail,this.inTail=!0);n-->y;)e+=this.dimension(this.get(n));return this.prevFirst=this.first,this.prevLast=this.last,this.first=y,this.last=f,e},animate:function(t,i){var r,u,e,f;this.locked||this.animating||(this.animating=!0,r=this,u=function(){if(r.animating=!1,t===0&&r.list.css(r.lt,0),!r.autoStopped&&(r.options.wrap=="circular"||r.options.wrap=="both"||r.options.wrap=="last"||r.options.size===null||r.last<r.options.size||r.last==r.options.size&&r.tail!==null&&!r.inTail)&&r.startAuto(),r.buttons(),r.notify("onAfterAnimation"),r.options.wrap=="circular"&&r.options.size!==null)for(var n=r.prevFirst;n<=r.prevLast;n++)n===null||n>=r.first&&n<=r.last||!(n<1||n>r.options.size)||r.remove(n)},this.notify("onBeforeAnimation"),this.options.animation&&i!==!1?(e=this.options.vertical?{top:t}:this.options.rtl?{right:t}:{left:t},f={duration:this.options.animation,easing:this.options.easing,complete:u},n.isFunction(this.options.animationStepCallback)&&(f.step=this.options.animationStepCallback),this.list.animate(e,f)):(this.list.css(this.lt,t+"px"),u()))},startAuto:function(n){if(n!==undefined&&(this.options.auto=n),this.options.auto===0)return this.stopAuto();if(this.timer===null){this.autoStopped=!1;var t=this;this.timer=window.setTimeout(function(){t.next()},this.options.auto*1e3)}},stopAuto:function(){this.pauseAuto();this.autoStopped=!0},pauseAuto:function(){this.timer!==null&&(window.clearTimeout(this.timer),this.timer=null)},buttons:function(n,t){n==null&&(n=!this.locked&&this.options.size!==0&&(this.options.wrap&&this.options.wrap!="first"||this.options.size===null||this.last<this.options.size),!this.locked&&(!this.options.wrap||this.options.wrap=="first")&&this.options.size!==null&&this.last>=this.options.size&&(n=this.tail!==null&&!this.inTail));t==null&&(t=!this.locked&&this.options.size!==0&&(this.options.wrap&&this.options.wrap!="last"||this.first>1),this.locked||this.options.wrap&&this.options.wrap!="last"||this.options.size===null||this.first!=1||(t=this.tail!==null&&this.inTail));var i=this;this.buttonNext.size()>0?(this.buttonNext.unbind(this.options.buttonNextEvent+".jcarousel",this.funcNext),n&&this.buttonNext.bind(this.options.buttonNextEvent+".jcarousel",this.funcNext),this.buttonNext[n?"removeClass":"addClass"](this.className("jcarousel-next-disabled")).attr("disabled",n?!1:!0),this.options.buttonNextCallback!==null&&this.buttonNext.data("jcarouselstate")!=n&&this.buttonNext.each(function(){i.options.buttonNextCallback(i,this,n)}).data("jcarouselstate",n)):this.options.buttonNextCallback!==null&&this.buttonNextState!=n&&this.options.buttonNextCallback(i,null,n);this.buttonPrev.size()>0?(this.buttonPrev.unbind(this.options.buttonPrevEvent+".jcarousel",this.funcPrev),t&&this.buttonPrev.bind(this.options.buttonPrevEvent+".jcarousel",this.funcPrev),this.buttonPrev[t?"removeClass":"addClass"](this.className("jcarousel-prev-disabled")).attr("disabled",t?!1:!0),this.options.buttonPrevCallback!==null&&this.buttonPrev.data("jcarouselstate")!=t&&this.buttonPrev.each(function(){i.options.buttonPrevCallback(i,this,t)}).data("jcarouselstate",t)):this.options.buttonPrevCallback!==null&&this.buttonPrevState!=t&&this.options.buttonPrevCallback(i,null,t);this.buttonNextState=n;this.buttonPrevState=t},notify:function(n){var t=this.prevFirst===null?"init":this.prevFirst<this.first?"next":"prev";this.callback("itemLoadCallback",n,t);this.prevFirst!==this.first&&(this.callback("itemFirstInCallback",n,t,this.first),this.callback("itemFirstOutCallback",n,t,this.prevFirst));this.prevLast!==this.last&&(this.callback("itemLastInCallback",n,t,this.last),this.callback("itemLastOutCallback",n,t,this.prevLast));this.callback("itemVisibleInCallback",n,t,this.first,this.last,this.prevFirst,this.prevLast);this.callback("itemVisibleOutCallback",n,t,this.prevFirst,this.prevLast,this.first,this.last)},callback:function(t,i,r,u,f,e,o){var h,c,l,s;if(this.options[t]!=null&&(typeof this.options[t]=="object"||i=="onAfterAnimation")&&(h=typeof this.options[t]=="object"?this.options[t][i]:this.options[t],n.isFunction(h)))if(c=this,u===undefined)h(c,r,i);else if(f===undefined)this.get(u).each(function(){h(c,this,u,r,i)});else for(l=function(n){c.get(n).each(function(){h(c,this,n,r,i)})},s=u;s<=f;s++)s===null||s>=e&&s<=o||l(s)},create:function(n){return this.format("<li><\/li>",n)},format:function(t,i){var u,r;for(t=n(t),u=t.get(0).className.split(" "),r=0;r<u.length;r++)u[r].indexOf("jcarousel-")!=-1&&t.removeClass(u[r]);return t.addClass(this.className("jcarousel-item")).addClass(this.className("jcarousel-item-"+i)).css({float:this.options.rtl?"right":"left","list-style":"none"}).attr("jcarouselindex",i),t},className:function(n){return n+" "+n+(this.options.vertical?"-vertical":"-horizontal")},dimension:function(i,r){var u=n(i),f;return r==null?this.options.vertical?u.outerHeight(!0)||t.intval(this.options.itemFallbackDimension):u.outerWidth(!0)||t.intval(this.options.itemFallbackDimension):(f=this.options.vertical?r-t.intval(u.css("marginTop"))-t.intval(u.css("marginBottom")):r-t.intval(u.css("marginLeft"))-t.intval(u.css("marginRight")),n(u).css(this.wh,f+"px"),this.dimension(u))},clipping:function(){return this.options.vertical?this.clip[0].offsetHeight-t.intval(this.clip.css("borderTopWidth"))-t.intval(this.clip.css("borderBottomWidth")):this.clip[0].offsetWidth-t.intval(this.clip.css("borderLeftWidth"))-t.intval(this.clip.css("borderRightWidth"))},index:function(n,t){return t==null&&(t=this.options.size),Math.round(((n-1)/t-Math.floor((n-1)/t))*t)+1}});t.extend({defaults:function(t){return n.extend(r,t||{})},intval:function(n){return n=parseInt(n,10),isNaN(n)?0:n},windowLoaded:function(){i=!0}});n.fn.jcarousel=function(i){if(typeof i=="string"){var r=n(this).data("jcarousel"),u=Array.prototype.slice.call(arguments,1);return r[i].apply(r,u)}return this.each(function(){var r=n(this).data("jcarousel");r?(i&&n.extend(r.options,i),r.reload()):n(this).data("jcarousel",new t(this,i))})}})(jQuery);